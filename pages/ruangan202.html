<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- FullCalendar CDN (CSS & JS) -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet" href="../style.css" />
    <link rel="icon" href="../assets/logo.png" type="image/png" />
    <title>Ruangan Kelas</title>
  </head>
  <body>
    <div class="container">
      <!-- aside menu -->
      <aside>
        <div class="name">
          <img src="../assets/logo.png" alt="logo" class="logo" />
          <h2 class="brand">
            Sistem  <br />
            Peminjaman Ruangan
          </h2>
          <h3 class="sub-brand">Sultan Ageng Tirtayasa</h3>
        </div>
        <div class="profile">
          <img src="../assets/profile.png" alt="profile" class="profile-img" />
          <h2 class="profile-name">User</h2>
          <h3 class="profile-status">Mahasiswa</h3>
        </div>
        <!-- menu -->
        <ul class="list">
          <li>
            <a href="./home.html">
              <div class="menu-item active">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="svg-arrow"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3"
                  />
                </svg>
                Ruangan Kelas
              </div>
            </a>
          </li>
          <li>
            <a href="./peminjaman.html">
              <div class="menu-item">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="svg-arrow"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3"
                  />
                </svg>
                Peminjaman
              </div>
            </a>
          </li>
          <li>
            <a href="./laporan.html">
              <div class="menu-item">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="svg-arrow"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3"
                  />
                </svg>
                Laporan Peminjaman
              </div>
            </a>
          </li>
          <li>
            <a href="./profil.html">
              <div class="menu-item">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="svg-arrow"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3"
                  />
                </svg>
                Profil
              </div>
            </a>
          </li>
        </ul>
        <a href="../index.html">
          <div class="logout">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="svg-logout"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"
              />
            </svg>
            Logout
          </div>
        </a>
      </aside>

      <!-- main content -->
      <main class="main">
        <header class="header">
          <h1 class="title-page">Ruang Kelas</h1>
          <div class="divider"></div>
          <div class="header-util">
            <div class="search-box">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="svg-search"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"
                />
              </svg>
              <input
                type="search"
                name="search"
                id="search"
                placeholder="Cari ruangan..."
                class="form-input search"
              />
            </div>
            <div class="notif">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="svg-notif"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"
                />
              </svg>
            </div>
          </div>
        </header>
        <div class="content">
          <div id="calendar"></div>
        
         <!-- Tambahkan di bagian content ruangan205.html -->
         <script>
          document.addEventListener('DOMContentLoaded', function() {
            const calendarEl = document.getElementById('calendar');
            let selectedRange = null;
            // Fungsi untuk localStorage
          function getAllBookings() {
            return JSON.parse(localStorage.getItem('roomBookings')) || [];
          }

          function saveBookingToStorage(booking) {
            const bookings = getAllBookings();
            bookings.push(booking);
            localStorage.setItem('roomBookings', JSON.stringify(bookings));
          }
            // Inisialisasi calendar
            const calendar = new FullCalendar.Calendar(calendarEl, {
              initialView: 'timeGridWeek',
              selectable: true,
              selectMirror: true,
              events: getAllBookings(), // Ambil data dari localStorage
              select: function(arg) {
                selectedRange = {
                  start: arg.start,
                  end: arg.end,
                  title: 'Peminjaman R2-05'
                };
                showBookingForm();
                
              },
              eventDidMount: function(info) {
                // Tambahkan tooltip
                new bootstrap.Tooltip(info.el, {
                  title: info.event.extendedProps.description,
                  placement: 'top',
                  trigger: 'hover',
                  container: 'body'
                });
                
              }
            });
          
            calendar.render();
          
            // Tampilkan form booking
            function showBookingForm() {
              const formHTML = `
                <div class="booking-overlay">
                  <div class="booking-form">
                    <h3>Form Peminjaman Ruangan</h3>
                    <div class="form-group">
                      <label>Waktu Mulai</label>
                      <input type="text" 
                        value="${selectedRange.start.toLocaleString()}" 
                        disabled>
                    </div>
                    <div class="form-group">
                      <label>Waktu Selesai</label>
                      <input type="text" 
                        value="${selectedRange.end.toLocaleString()}" 
                        disabled>
                    </div>
                    <div class="form-group">
                      <label>Keterangan</label>
                      <textarea id="booking-description" 
                        placeholder="Contoh: Rapat Prodi Teknik Informatika"
                        required></textarea>
                    </div>
                    <div class="form-actions">
                      <button class="btn-submit">Ajukan</button>
                      <button class="btn-cancel">Batal</button>
                    </div>
                  </div>
                </div>
              `;
          
              document.body.insertAdjacentHTML('beforeend', formHTML);
          
              // Event listeners untuk tombol
              document.querySelector('.btn-submit').addEventListener('click', submitBooking);
              document.querySelector('.btn-cancel').addEventListener('click', closeForm);
            }
          
            // Fungsi submit booking
            function submitBooking() {
              const description = document.getElementById('booking-description').value;
              
              if (!description) {
                alert('Harap isi keterangan peminjaman!');
                return;
              }
          
              const newBooking = {
                title: 'Booked',
                start: selectedRange.start,
                end: selectedRange.end,
                color: '#ff9f89',
                extendedProps: {
                  description: description,
                  room: 'R2-05',
                  status: 'pending'
                }
              };
          
              // Simpan ke localStorage
              saveBookingToStorage(newBooking);
              
              // Tambahkan ke calendar
              calendar.addEvent(newBooking);
              
              // Reset form
              closeForm();
              alert('Peminjaman berhasil diajukan!');
            }
          
            // Fungsi tutup form
            function closeForm() {
              document.querySelector('.booking-overlay').remove();
            }
          
          });
              

          </script>
        </div>
      </main>
    </div>

    <script src="../app.js"></script>
  </body>
</html>
